{"version":3,"file":"reactnativeinfo.js","sourceRoot":"","sources":["../../../src/js/integrations/reactnativeinfo.ts"],"names":[],"mappings":";AAEA,OAAO,EACL,gBAAgB,EAChB,qBAAqB,EACrB,MAAM,EACN,eAAe,EACf,eAAe,EACf,oBAAoB,GACrB,MAAM,sBAAsB,CAAC;AAa9B,4CAA4C;AAC5C,MAAM,OAAO,eAAe;IAA5B;QAME;;WAEG;QACI,SAAI,GAAW,eAAe,CAAC,EAAE,CAAC;IA6C3C,CAAC;IA3CC;;OAEG;IACI,SAAS,CAAC,uBAA2D;QAC1E,uBAAuB,CAAC,CAAO,KAAY,EAAE,IAAgB,EAAE,EAAE;YAC/D,MAAM,gBAAgB,GAAG,CAAA,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,iBAAiB,EAAC,CAAC,CAAE,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,iBAAsC,CAAC,CAAC,CAAC,SAAS,CAAC;YAE7G,MAAM,kBAAkB,GAAuB;gBAC7C,YAAY,EAAE,oBAAoB,EAAE;gBACpC,MAAM,EAAE,eAAe,EAAE;gBACzB,oBAAoB,EAAE,qBAAqB,EAAE;gBAC7C,IAAI,EAAE,MAAM,EAAE;aACf,CAAC;YAEF,IAAI,eAAe,EAAE,EAAE;gBACrB,kBAAkB,CAAC,SAAS,GAAG,QAAQ,CAAC;gBACxC,MAAM,aAAa,GAAG,gBAAgB,EAAE,CAAC;gBACzC,IAAI,aAAa,EAAE;oBACjB,kBAAkB,CAAC,cAAc,GAAG,gBAAgB,EAAE,CAAC;iBACxD;aACF;iBAAM,IAAI,gBAAgB,aAAhB,gBAAgB,uBAAhB,gBAAgB,CAAE,QAAQ,EAAE;gBACrC,kBAAkB,CAAC,SAAS,GAAG,gBAAgB,CAAC,QAAQ,CAAC;aAC1D;YAED,IAAI,kBAAkB,CAAC,SAAS,KAAK,QAAQ,EAAE;gBAC7C,KAAK,CAAC,IAAI,mBACR,MAAM,EAAE,MAAM,IACX,KAAK,CAAC,IAAI,CACd,CAAC;aACH;YAED,IAAI,gBAAgB,aAAhB,gBAAgB,uBAAhB,gBAAgB,CAAE,cAAc,EAAE;gBACpC,kBAAkB,CAAC,eAAe,GAAG,gBAAgB,CAAC,cAAc,CAAC;aACtE;YAED,KAAK,CAAC,QAAQ,mBACZ,oBAAoB,EAAE,kBAAkB,IACrC,KAAK,CAAC,QAAQ,CAClB,CAAC;YAEF,OAAO,KAAK,CAAC;QACf,CAAC,CAAA,CAAC,CAAC;IACL,CAAC;;AApDD;;GAEG;AACW,kBAAE,GAAW,iBAAiB,CAAC","sourcesContent":["import type { Context, Event, EventHint, EventProcessor, Integration } from '@sentry/types';\n\nimport {\n  getHermesVersion,\n  getReactNativeVersion,\n  isExpo,\n  isFabricEnabled,\n  isHermesEnabled,\n  isTurboModuleEnabled,\n} from '../utils/environment';\nimport type { ReactNativeError } from './debugsymbolicator';\n\nexport interface ReactNativeContext extends Context {\n  js_engine?: string;\n  turbo_module: boolean;\n  fabric: boolean;\n  expo: boolean;\n  hermes_version?: string;\n  react_native_version: string;\n  component_stack?: string;\n}\n\n/** Loads React Native context at runtime */\nexport class ReactNativeInfo implements Integration {\n  /**\n   * @inheritDoc\n   */\n  public static id: string = 'ReactNativeInfo';\n\n  /**\n   * @inheritDoc\n   */\n  public name: string = ReactNativeInfo.id;\n\n  /**\n   * @inheritDoc\n   */\n  public setupOnce(addGlobalEventProcessor: (callback: EventProcessor) => void): void {\n    addGlobalEventProcessor(async (event: Event, hint?: EventHint) => {\n      const reactNativeError = hint?.originalException ? (hint?.originalException as ReactNativeError) : undefined;\n\n      const reactNativeContext: ReactNativeContext = {\n        turbo_module: isTurboModuleEnabled(),\n        fabric: isFabricEnabled(),\n        react_native_version: getReactNativeVersion(),\n        expo: isExpo(),\n      };\n\n      if (isHermesEnabled()) {\n        reactNativeContext.js_engine = 'hermes';\n        const hermesVersion = getHermesVersion();\n        if (hermesVersion) {\n          reactNativeContext.hermes_version = getHermesVersion();\n        }\n      } else if (reactNativeError?.jsEngine) {\n        reactNativeContext.js_engine = reactNativeError.jsEngine;\n      }\n\n      if (reactNativeContext.js_engine === 'hermes') {\n        event.tags = {\n          hermes: 'true',\n          ...event.tags,\n        };\n      }\n\n      if (reactNativeError?.componentStack) {\n        reactNativeContext.component_stack = reactNativeError.componentStack;\n      }\n\n      event.contexts = {\n        react_native_context: reactNativeContext,\n        ...event.contexts,\n      };\n\n      return event;\n    });\n  }\n}\n"]}